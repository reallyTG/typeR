test_that("triangle", {
    expect_equal(triangle(-5,  0, 1, 2), 0)
    expect_equal(triangle(-1,  0, 1, 2), 0)
    expect_equal(triangle(0,   0, 1, 2), 0)
    expect_equal(triangle(0.5, 0, 1, 2), 0.5)
    expect_equal(triangle(1,   0, 1, 2), 1)
    expect_equal(triangle(1.5, 0, 1, 2), 0.5)
    expect_equal(triangle(2,   0, 1, 2), 0)
    expect_equal(triangle(10,  0, 1, 2), 0)

    expect_equal(triangle(-1,  1, 1, 2), 0)
    expect_equal(triangle(0,   1, 1, 2), 0)
    expect_equal(triangle(1,   1, 1, 2), 1)
    expect_equal(triangle(1.5, 1, 1, 2), 0.5)
    expect_equal(triangle(2,   1, 1, 2), 0)
    expect_equal(triangle(10,  1, 1, 2), 0)

    expect_equal(triangle(-1,  0, 1, 1), 0)
    expect_equal(triangle(0,   0, 1, 1), 0)
    expect_equal(triangle(0.5, 0, 1, 1), 0.5)
    expect_equal(triangle(1,   0, 1, 1), 1)
    expect_equal(triangle(2,   0, 1, 1), 0)
    expect_equal(triangle(10,  0, 1, 1), 0)

    expect_equal(triangle(0,   1, 1, 1), 0)
    expect_equal(triangle(1,   1, 1, 1), 1)
    expect_equal(triangle(2,   1, 1, 1), 0)

    expect_equal(triangle(-5,  -Inf, 1, 2), 1)
    expect_equal(triangle(0,   -Inf, 1, 2), 1)
    expect_equal(triangle(1,   -Inf, 1, 2), 1)
    expect_equal(triangle(1.5, -Inf, 1, 2), 0.5)
    expect_equal(triangle(2,   -Inf, 1, 2), 0)
    expect_equal(triangle(5,   -Inf, 1, 2), 0)

    expect_equal(triangle(0,   0, 1, Inf), 0)
    expect_equal(triangle(0.5, 0, 1, Inf), 0.5)
    expect_equal(triangle(1,   0, 1, Inf), 1)
    expect_equal(triangle(2,   0, 1, Inf), 1)
    expect_equal(triangle(5,   0, 1, Inf), 1)

    expect_equal(triangle(-5,  -Inf, 1, Inf), 1)
    expect_equal(triangle(0,   -Inf, 1, Inf), 1)
    expect_equal(triangle(1,   -Inf, 1, Inf), 1)
    expect_equal(triangle(2,   -Inf, 1, Inf), 1)
    expect_equal(triangle(5,   -Inf, 1, Inf), 1)

    expect_equal(triangle(1,   -Inf, -Inf, Inf), 1)
    expect_equal(triangle(1,   -Inf, Inf, Inf), 1)
})
