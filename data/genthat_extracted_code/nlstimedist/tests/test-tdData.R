context("Test the data cleaning function: tdData")

test_that("tdData output is as expected", {

  out <- tdData(tilia, x = "Day", y = "Trees")
  expected <-
    structure(list(
      raw = structure(
        list(
          Day = c(
            94L, 95L, 96L, 103L,
            104L, 105L, 106L, 107L, 108L, 110L, 111L, 112L, 113L, 114L, 115L,
            116L, 115L, 117L, 118L, 119L, 120L, 121L, 122L, 123L, 124L, 125L,
            126L, 127L, 128L, 129L, 130L, 131L, 133L, 134L),
          Trees = c(
            0L,
            0L, 1L, 1L, 0L, 3L, 0L, 1L, 0L, 4L, 7L, 3L, 0L, 1L, 3L, 6L, 0L,
            3L, 2L, 2L, 5L, 2L, 2L, 4L, 1L, 0L, 3L, 1L, 1L, 1L, 2L, 4L, 1L,
            1L)),
        row.names = c(NA, -34L),
        class = "data.frame",
        .Names = c("Day", "Trees")),
      clean = structure(
        list(
          Day = c(
            96L, 103L, 105L, 107L, 110L, 111L, 112L, 114L, 115L, 116L, 117L,
            118L, 119L, 120L, 121L, 122L, 123L, 124L, 126L, 127L, 128L, 129L,
            130L, 131L, 133L, 134L),
          Trees = c(1, 1, 3, 1, 4, 7, 3, 1, 3, 6, 3, 2, 2, 5, 2, 2, 4, 1, 3, 1,
                    1, 1, 2, 4, 1, 1),
          cumN = c(1, 2, 5, 6, 10, 17, 20, 21, 24, 30, 33, 35, 37, 42, 44, 46,
                   50, 51, 54, 55, 56, 57, 59, 63, 64, 65),
          propMax = c(0.0153846153846154, 0.0307692307692308,
                      0.0769230769230769, 0.0923076923076923,
                      0.153846153846154, 0.261538461538462,
                      0.307692307692308, 0.323076923076923, 0.369230769230769,
                      0.461538461538462, 0.507692307692308, 0.538461538461538,
                      0.569230769230769, 0.646153846153846, 0.676923076923077,
                      0.707692307692308, 0.769230769230769, 0.784615384615385,
                      0.830769230769231, 0.846153846153846, 0.861538461538462,
                      0.876923076923077, 0.907692307692308, 0.969230769230769,
                      0.984615384615385, 1)),
        class = "data.frame",
        .Names = c("Day", "Trees", "cumN", "propMax"),
        row.names = c(NA, -26L))),
      .Names = c("raw", "clean"), class = "td")

  expect_equal(out, expected)

})
