library(simmr)


### Name: compare_groups
### Title: Compare dietary proportions for a single source across different
###   groups
### Aliases: compare_groups

### ** Examples
## Not run: 
##D mix = matrix(c(10.22, 10.37, 10.44, 10.52, 10.19, 10.45, 9.91, 11.27, 
##D                9.34, 11.68, 12.29, 11.04, 11.46, 11.73, 12.29, 11.79, 11.49, 
##D                11.73, 11.1, 11.36, 12.19, 11.03, 11.21, 10.58, 11.61, 12.16, 
##D                10.7, 11.47, 12.07, 11.75, 11.86, 12.33, 12.36, 11.13, 10.92, 
##D                12.42, 10.95, 12.28, 11.04, 10.76, 10.99, 10.78, 11.07, 10.2, 
##D                11.67, 7.53, 10.65, 10.58, 11.13, 7.73, 10.79, 10.47, 10.82, 
##D                10.41, 11.1, 10.95, 10.76, 10.83, 10.25, 10.52, 9.94, 9.94, 11.61, 
##D                10.65, 10.76, 11.11, 10.2, 11.27, 10.21, 10.88, 11.21, 11.36, 
##D                10.75, 12.38, 11.16, 11.57, 10.79, 11.13, 10.72, 10.99, 10.38, 
##D                10.95, 10.75, 10.75, 11.05, 10.66, 10.61, 10.9, 11.14, 10.33, 
##D                10.83, 10.75, 9.18, 9.03, 9.05, 8.6, 8.29, 10.32, 10.28, 6.47, 
##D                11.36, 10.75, 11.13, 11.37, 10.86, 10.54, 10.39, 10.66, 9.99, 
##D                11.65, 11.02, 10.67, 8.15, 11.12, 10.95, 11.2, 10.76, 11.32, 
##D                10.85, 11.74, 10.46, 10.93, 12.3, 10.67, 11.51, 10.56, 12.51, 
##D                13.51, 11.98, 12.2, 10.48, 12.4, 13, 11.36, 12.08, 12.39, 12.28, 
##D                12.6, 11.3, 11.1, 11.42, 11.49, 12, 13.35, 11.97, 13.35, 12.75, 
##D                12.55, 12.3, 12.51, 12.61, 10.98, 11.82, 12.27, 12.11, 12.11, 
##D                12.89, 12.99, 12.29, 11.89, 12.74, 12.29, 11.89, 10.56, 9.27, 
##D                10.54, 10.97, 10.46, 10.56, 10.86, 10.9, 11.06, 10.76, 10.64, 
##D                10.94, 10.85, 10.45, 11.15, 11.23, 11.16, 10.94, 11.2, 10.71, 
##D                9.55, 8.6, 9.67, 8.17, 9.81, 10.94, 9.49, 9.46, 7.94, 9.77, 8.07, 
##D                8.39, 8.95, 9.83, 8.51, 8.86, 7.93, 8, 8.33, 8, 9.39, 8.01, 7.59, 
##D                8.26, 9.49, 8.23, 9.1, 8.21, 9.59, 9.37, 9.47, 8.6, 8.23, 8.39, 
##D                8.24, 8.34, 8.36, 7.22, 7.13, 10.64, 8.06, 8.22, 8.92, 9.35, 
##D                7.32, 7.66, 8.09, 7.3, 7.33, 7.33, 7.36, 7.49, 8.07, 8.84, 7.93, 
##D                7.94, 8.74, 8.26, 9.63, 8.85, 7.55, 10.05, 8.23, 7.74, 9.12, 
##D                7.33, 7.54, 8.8, -11.36, -11.88, -10.6, -11.25, -11.66, -10.41, 
##D                -10.88, -14.73, -11.52, -15.89, -14.79, -17.64, -16.97, -17.25, 
##D                -14.77, -15.67, -15.34, -15.53, -17.27, -15.63, -15.94, -14.88, 
##D                -15.9, -17.11, -14.93, -16.26, -17.5, -16.37, -15.21, -15.43, 
##D                -16.54, -15, -16.41, -15.09, -18.06, -16.27, -15.08, -14.39, 
##D                -21.45, -22.52, -21.25, -21.84, -22.51, -21.97, -20.23, -21.64, 
##D                -22.49, -21.91, -21.65, -21.37, -22.9, -21.13, -19.33, -20.29, 
##D                -20.56, -20.87, -21.07, -21.69, -21.17, -21.74, -22.69, -21.06, 
##D                -20.42, -21.5, -20.15, -21.99, -22.3, -21.71, -22.48, -21.86, 
##D                -21.68, -20.97, -21.91, -19.05, -22.78, -22.36, -22.46, -21.52, 
##D                -21.84, -21.3, -21.39, -22.1, -21.59, -20.14, -20.67, -20.31, 
##D                -20.07, -21.2, -20.44, -22.06, -22.05, -21.44, -21.93, -22.47, 
##D                -22.27, -22.19, -22.81, -20.48, -22.47, -18.06, -20.72, -20.97, 
##D                -19.11, -18.4, -20.45, -21.2, -19.74, -20.48, -21.48, -17.81, 
##D                -19.77, -22.56, -14.72, -12.21, -12.35, -13.88, -14.43, -14.65, 
##D                -13.9, -14.12, -10.88, -10.44, -15.33, -13.78, -13.98, -15.22, 
##D                -15.25, -15.76, -15.78, -15.49, -13.02, -15.3, -15.55, -14.35, 
##D                -14.99, -14.83, -16.18, -15.01, -12.87, -14.67, -13.84, -14.89, 
##D                -13.33, -15.04, -14.29, -15.62, -13.99, -15.06, -15.06, -15, 
##D                -14.55, -13.32, -14.34, -14.47, -14.31, -14.18, -16.18, -16.25, 
##D                -15.92, -15.35, -14.29, -15.92, -15.35, -20.22, -21.4, -19.97, 
##D                -20.78, -20.61, -20.58, -20.19, -20.71, -20.59, -20.09, -19.37, 
##D                -20.41, -20.84, -20.75, -20.29, -20.89, -19.69, -20.41, -21.24, 
##D                -19.33, -25.87, -25.4, -27.23, -27.52, -24.55, -17.36, -24.7, 
##D                -27.76, -28.92, -25.98, -26.77, -28.76, -27.7, -24.75, -25.47, 
##D                -26.58, -28.94, -29.13, -26.65, -28.04, -27.5, -29.28, -27.85, 
##D                -27.41, -27.57, -29.06, -25.98, -28.21, -25.27, -14.43, -27.4, 
##D                -27.76, -28.45, -27.35, -28.83, -29.39, -28.86, -28.61, -29.27, 
##D                -20.32, -28.21, -26.3, -28.27, -27.75, -28.55, -27.38, -29.13, 
##D                -28.66, -29.02, -26.04, -26.06, -28.52, -28.51, -27.93, -29.07, 
##D                -28.41, -26.42, -27.71, -27.75, -24.28, -28.43, -25.94, -28, 
##D                -28.59, -22.61, -27.34, -27.35, -29.14), ncol=2, nrow=251)
##D colnames(mix) = c('d13C','d15N')
##D s_names = c("Zostera", "Grass", "U.lactuca", "Enteromorpha")
##D s_means = matrix(c(6.49, 4.43, 11.19, 9.82, -11.17, -30.88, -11.17, 
##D                    -14.06), ncol=2, nrow=4)
##D s_sds = matrix(c(1.46, 2.27, 1.11, 0.83, 1.21, 0.64, 1.96, 1.17), ncol=2, nrow=4)
##D c_means = matrix(c(3.54, 3.54, 3.54, 3.54, 1.63, 1.63, 1.63, 1.63), ncol=2, nrow=4)
##D c_sds = matrix(c(0.74, 0.74, 0.74, 0.74, 0.63, 0.63, 0.63, 0.63), ncol=2, nrow=4)
##D conc = matrix(c(0.03, 0.04, 0.02, 0.01, 0.36, 0.4, 0.21, 0.18), ncol=2, nrow=4)
##D grp = as.integer(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 
##D         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 
##D         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 
##D         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 
##D         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 
##D         3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 
##D         5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 
##D         5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 
##D         6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 
##D         7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 
##D         7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 
##D         8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8))
##D 
##D # Load this in:
##D simmr_3 = simmr_load(mixtures=mix,
##D                      source_names=s_names,
##D                      source_means=s_means,
##D                      source_sds=s_sds,
##D                      correction_means=c_means,
##D                      correction_sds=c_sds,
##D                      concentration_means = conc,
##D                      group=grp)
##D 
##D # Print
##D simmr_in
##D 
##D # Plot
##D plot(simmr_in,group=1:8,xlab=expression(paste(delta^13, "C (\u2030)",sep="")), 
##D      ylab=expression(paste(delta^15, "N (\u2030)",sep="")), 
##D      title='Isospace plot of Inger et al Geese data')
##D 
##D # Run MCMC for each group
##D simmr_out = simmr_mcmc(simmr_in)
##D 
##D # Print output
##D simmr_out
##D 
##D # Summarise output
##D summary(simmr_out,type='quantiles',group=1)
##D summary(simmr_out,type='quantiles',group=c(1,3))
##D summary(simmr_out,type=c('quantiles','statistics'),group=c(1,3))
##D 
##D # Plot - only a single group allowed
##D plot(simmr_out,type='boxplot',group=2,title='simmr output group 2')
##D plot(simmr_out,type=c('density','matrix'),grp=6,title='simmr output group 6')
##D 
##D # Compare groups
##D compare_groups(simmr_out,source='Zostera',groups=1:2)
##D compare_groups(simmr_out,source='Zostera',groups=1:3)
##D compare_groups(simmr_out,source='U.lactuca',groups=c(4:5,7,2))
## End(Not run)



